{% extends "smarthome/base_user.html" %}

{% block title %}Devices - SmartHome{% endblock %}

{% block content %}
<div class="header"><h2>Devices:</h2></div>

<div class="content">
{% if devices %}
    <table class="tableDevices">
        <tr>
            <th></th>
            <th>Device</th>
            <th>Type</th>
            <th>Room</th>
        </tr>
        {% for device in devices %}
        <tr>
            <td>{% if device.state %}<svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#2a9e00"><path d="M480-80q-83 0-156-31.5T197-197q-54-54-85.5-127T80-480q0-83 31.5-156T197-763q54-54 127-85.5T480-880q83 0 156 31.5T763-763q54 54 85.5 127T880-480q0 83-31.5 156T763-197q-54 54-127 85.5T480-80Zm0-80q134 0 227-93t93-227q0-134-93-227t-227-93q-134 0-227 93t-93 227q0 134 93 227t227 93Zm0-80q100 0 170-70t70-170q0-51-19-94.5T650-650l-57 57q22 22 34.5 51t12.5 62q0 66-47 113t-113 47q-66 0-113-47t-47-113q0-33 12.5-62t34.5-51l-57-57q-32 32-51 75.5T240-480q0 100 70 170t170 70Zm-40-240h80v-240h-80v240Zm40 0Z"/></svg>
                {% elif not device.state and device.power_on %}<svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#bd0000"><path d="M480-80q-83 0-156-31.5T197-197q-54-54-85.5-127T80-480q0-83 31.5-156T197-763q54-54 127-85.5T480-880q83 0 156 31.5T763-763q54 54 85.5 127T880-480q0 83-31.5 156T763-197q-54 54-127 85.5T480-80Zm0-80q134 0 227-93t93-227q0-134-93-227t-227-93q-134 0-227 93t-93 227q0 134 93 227t227 93Zm0-80q100 0 170-70t70-170q0-51-19-94.5T650-650l-57 57q22 22 34.5 51t12.5 62q0 66-47 113t-113 47q-66 0-113-47t-47-113q0-33 12.5-62t34.5-51l-57-57q-32 32-51 75.5T240-480q0 100 70 170t170 70Zm-40-240h80v-240h-80v240Zm40 0Z"/></svg>
                {% elif not device.power_on %}<svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#434343"><path d="M480-80q-83 0-156-31.5T197-197q-54-54-85.5-127T80-480q0-83 31.5-156T197-763q54-54 127-85.5T480-880q83 0 156 31.5T763-763q54 54 85.5 127T880-480q0 83-31.5 156T763-197q-54 54-127 85.5T480-80Zm0-80q134 0 227-93t93-227q0-134-93-227t-227-93q-134 0-227 93t-93 227q0 134 93 227t227 93Zm0-80q100 0 170-70t70-170q0-51-19-94.5T650-650l-57 57q22 22 34.5 51t12.5 62q0 66-47 113t-113 47q-66 0-113-47t-47-113q0-33 12.5-62t34.5-51l-57-57q-32 32-51 75.5T240-480q0 100 70 170t170 70Zm-40-240h80v-240h-80v240Zm40 0Z"/></svg>
                {% endif %}</td>
            <td><a href="{% url 'devices:details' device.id %}" title="See details">{{ device.device_name }}</a></td>
            <td>{{ device.device_type }}</td>
            <td>{% if device.device_room %}{{ device.device_room }}{% endif %}</td>
            <td><form method="get" action="{% url 'devices:edit_device' device.id %}">
                    <button type="submit">Edit</button>
                </form></td>
            <td><form method="POST" action="{% url 'devices:delete_device' device.id %}">
                    {% csrf_token %}
                    <button type="submit" class="buttonDelete" onclick="return confirm('Are you sure you want to delete this device?')">Delete</button>
                </form></td>
        </tr>
        {% endfor %}
    </table>
{% else %}
    <p>You have no devices yet.</p>
{% endif %}

<button onclick="window.location='{% url 'devices:new_device' %}'">+ Add device</button>
</div>

<button onclick="window.location='{% url 'stats:export' 'all-devices' %}'">Download devices log</button>
{% endblock %}

